import{bN as E,a as _,N as j,r as z,E as G,o as H,c as J,d as a,w as l,e as o,aM as x,T as K,i as p,a2 as F,a0 as M,f as c,g as $}from"./index.1bb11c7d.js";import{E as L}from"./el-dialog.ffa9934a.js";import"./el-overlay.1f7d1ab9.js";import{E as O,a as Q}from"./el-form-item.18bec942.js";import{a as W,E as X}from"./el-input.424f7e03.js";import{E as Y}from"./el-tree.5fcf89d9.js";import"./el-checkbox.46989ebd.js";import{E as Z}from"./el-message-box.01abd863.js";import"./index.08af8a2a.js";import"./scroll.292c786e.js";import"./validator.0d104d86.js";let ee=i=>E.get("/menu/all",{params:i}),le=i=>E.get("/menu/sub",{params:i}),te=i=>E.post("/menu",i),ae=(i,r)=>E.delete(`/menu/${i}`,{params:r}),oe=(i,r)=>E.put(`/menu/${i}`,r);const C={list:ee,chlidren:le,add:te,remove:ae,edit:oe};const se=p("div",{class:"card-header"},[p("span",null,"\u83DC\u5355\u6743\u9650")],-1),ne={class:"custom-tree-node"},ie={class:"action"},re=c(" \u7F16\u8F91"),de=c("\u6DFB\u52A0"),ue=c(" \u5220\u9664"),me=p("span",{class:"text"},"\u663E\u793A\u5E8F\u53F7\uFF1A",-1),_e={class:"dialog-footer"},pe=c("\u53D6\u6D88"),ce=c("\u6DFB\u52A0"),fe={class:"dialog-footer"},ve=c("\u53D6\u6D88"),ge=c("\u6DFB\u52A0"),Be={__name:"Menu",setup(i){let r=_([]);const T={label:"name"};j(async()=>{let{status:n,msg:e,data:s}=await C.list({type:"tree"});n&&(r.value=s)});let B=z({name:[{required:!0,message:"\u8BF7\u8F93\u5165\u6B63\u786E\u7684\u5206\u7C7B\u540D\u79F0\uFF01",trigger:"blur"}]}),d=_({}),w=_({}),D=_(),u=_(!1),f=_({name:""}),P=(n,e)=>{u.value=!0,f.value={...e},d.value=e,w.value=n},R=n=>{n.validate(async e=>{if(e){let{status:s,msg:v,data:g}=await C.edit(f.value.id,{...f.value});s?(w.value.data={...f.value},u.value=!1):console.log("aaa")}})},I=_(),m=_(!1),b=z({name:""}),q=(n,e)=>{m.value=!0,d.value=e,w.value=n,console.log(e),console.log(n)},A=n=>{n.validate(async e=>{if(e){let{status:s,msg:v,data:g}=await C.add({...b,component:d.value.component,pId:d.value.id,path:d.value.path,menu_order:d.value.menu_order});if(s){const y={...g,...b,childern:[]};d.value.childern||(d.value.childern=[]),d.value.childern.push(y),r.value=[...r.value],m.value=!1}}})},S=(n,e)=>{Z.confirm("\u6B64\u64CD\u4F5C\u5C06\u6C38\u4E45\u5220\u9664\u8BE5\u5206\u7C7B\uFF0C\u786E\u5B9A\u5220\u9664\u561B\uFF1F",{type:"warning"}).then(async()=>{console.log(e);let{status:s,msg:v}=await C.remove(e.id,{id:e.id});if(console.log(s,v),s){const g=n.parent,y=g.data.children||g.data,k=y.findIndex(V=>V.id===e.id);y.splice(k,1),r.value=[...r.value],$.success(v)}else $.error(v)}).catch(()=>{$.info("\u53D6\u6D88\u6210\u529F")})};return(n,e)=>{const s=G,v=Y,g=W,y=X,k=O,V=Q,N=L;return H(),J(K,null,[a(g,{class:"box-card"},{header:l(()=>[se]),default:l(()=>[a(v,{data:o(r),props:T,"default-expand-all":""},{default:l(({node:t,data:h})=>[p("span",ne,[p("span",null,F(t.label),1),p("div",ie,[a(s,{icon:"edit",onClick:M(U=>o(P)(t,h),["stop"]),disabled:h.id===1,type:"primary",link:"",size:"small"},{default:l(()=>[re]),_:2},1032,["onClick","disabled"]),a(s,{icon:"CirclePlus",onClick:M(U=>o(q)(t,h),["stop"]),type:"primary",link:"",size:"small"},{default:l(()=>[de]),_:2},1032,["onClick"]),a(s,{icon:"delete",onClick:M(U=>o(S)(t,h),["stop"]),disabled:h.id===1,type:"primary",link:"",size:"small"},{default:l(()=>[ue]),_:2},1032,["onClick","disabled"]),me,a(s,{class:"buttonnumber",type:"primary",plain:""},{default:l(()=>[c(F(h.menu_order),1)]),_:2},1024)])])]),_:1},8,["data"])]),_:1}),a(N,{modelValue:o(u),"onUpdate:modelValue":e[3]||(e[3]=t=>x(u)?u.value=t:u=t),title:"\u6DFB\u52A0\u8282\u70B9"},{footer:l(()=>[p("span",_e,[a(s,{onClick:e[1]||(e[1]=t=>x(u)?u.value=!1:u=!1)},{default:l(()=>[pe]),_:1}),a(s,{type:"primary",onClick:e[2]||(e[2]=t=>o(R)(o(D)))},{default:l(()=>[ce]),_:1})])]),default:l(()=>[a(V,{ref_key:"edit_form_ref",ref:D,rules:o(B),model:o(f)},{default:l(()=>[a(k,{label:"\u5206\u7C7B\u540D\u79F0",prop:"name","status-icon":"","label-width":"80px"},{default:l(()=>[a(y,{modelValue:o(f).name,"onUpdate:modelValue":e[0]||(e[0]=t=>o(f).name=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"]),a(N,{modelValue:o(m),"onUpdate:modelValue":e[7]||(e[7]=t=>x(m)?m.value=t:m=t),title:"\u6DFB\u52A0\u8282\u70B9"},{footer:l(()=>[p("span",fe,[a(s,{onClick:e[5]||(e[5]=t=>x(m)?m.value=!1:m=!1)},{default:l(()=>[ve]),_:1}),a(s,{type:"primary",onClick:e[6]||(e[6]=t=>o(A)(o(I)))},{default:l(()=>[ge]),_:1})])]),default:l(()=>[a(V,{ref_key:"insert_form_ref",ref:I,rules:o(B),model:o(b)},{default:l(()=>[a(k,{label:"\u5206\u7C7B\u540D\u79F0",prop:"name","status-icon":"","label-width":"80px"},{default:l(()=>[a(y,{modelValue:o(b).name,"onUpdate:modelValue":e[4]||(e[4]=t=>o(b).name=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["rules","model"])]),_:1},8,["modelValue"])],64)}}};export{Be as default};
